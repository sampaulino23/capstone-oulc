<!DOCTYPE html>

<html>

<head>
    <title>Contract Approval Request</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="/css/specificrequeststyle.css">
    <script src="/js/specificrequest.js" type="text/javascript"></script>
</head>

<body>
    <div id="header">
        Third Party Negotiation
        
        <!--<input type="hidden" id="requestid" value="{{contractrequest._id}}">-->
        <input type="hidden" id="username" value="{{user.fullName}}">
        <input type="hidden" id="negotiationid" value="{{negotiation._id}}">
        
        
        <div id = "status">
            <div class = "status-text">Status:</div>
            <div class = "status-text actual">{{contractrequest.status}}</div>
            <input type="hidden" id="statusCounter" name="statusCounter" value="{{contractrequest.statusCounter}}">
            <input type="hidden" id="contractRequestId" name="contractRequestId" value="{{contractrequest._id}}">
            <input type="hidden" id="contractStatus" name="contractStatus" value="{{contractrequest.status}}">
            <input type="hidden" id="assignedAttorneyId" name="assignedAttorneyId" value="{{contractrequest.assignedAttorney._id}}">
            <input type="hidden" id="currentUserId" name="currentUserId" value="{{user._id}}">
        </div>
    </div>
    <div class = "subheader-row">
        <div class = "col-6">
            <div id="subheader"><span id = "selected" class = "full-user-name">Welcome, {{user.fullName}}!</span></div>
        </div>
        <div class="col-6">
            <button class="full-size-btn" data-bs-toggle="modal" data-bs-target="#view-full-size-modal">View Full Size</button> 
        </div>
    </div>
    

    <div class="container">
        <div class="row">
            <!-- LEFT SIDE -->
            <div class="left-col col-6">
                <div class="input-group mb-3">
                    <span class="file-selected input-group-text">File Selected:</span>  
                    <select class="form-select" name="fileSelected" id="fileSelected" aria-label="file-selected">
                        {{#each latestversioncontracts}}
                            <option class="contract-option" value="{{file}}">{{filename}}</option>
                        {{/each}}
                        {{#each referencedocuments}}
                            <option class="reference-document-option" value="{{file}}">{{filename}}</option>
                        {{/each}}
                    </select>
                </div>
                <div id="fileView">
                </div>
            </div>

            <!-- RIGHT SIDE -->
            <div id = "right-col" class="col-6">
                <!-- Nav tabs -->
             
                <ul class="nav nav-tabs" id="myTab" role="tablist" style="justify-content:flex-start;">
                    <li>
                        <button class="active nav-item selected" id="summary-tab" data-bs-toggle="tab" data-bs-target="#summary"
                            type="button" role="tab" aria-controls="summary" onclick="selectSummary()" style="margin-right: 2em;">Summary</button>
                    </li>
                    <li style="display:none;">
                        <button class="nav-item" id="files-tab" data-bs-toggle="tab" data-bs-target="#files"
                            type="button" role="tab" aria-controls="files" style="margin-right: 2em;" onclick="selectFiles()">Files</button>
                    </li>
                     <li>
                        <button class="nav-item" id="negotiation-tab" data-bs-toggle="tab" data-bs-target="#negotiation"
                            type="button" role="tab" aria-controls="negotiation" onclick="selectNegotiation()">Negotiation</button>
                    </li>
                </ul>

                <!-- Tab panes -->

                <div class="tab-content">
                    <div class="tab-pane active" id="summary" role="tabpanel" aria-labelledby="summary-tab">
                        {{>summary}}
                    </div>
                    <div class="tab-pane" id="files" role="tabpanel" aria-labelledby="files-tab">
                        {{>files}}
                    </div>
                    <div class="tab-pane" id="negotiation" role="tabpanel" aria-labelledby="negotiation-tab">
                        {{>negotiation}}
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- View Full Size Template Modal -->
    <div class="modal fade modal-xl" id="view-full-size-modal" tabindex="-1" aria-labelledby="view-full-size-modal" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title w-100" id="exampleModalLabel">View File Full Size</h5>
                    <button type="button" class="header-close-btn" data-bs-dismiss="modal">
                        &times;
                    </button>
                </div>
                <div class="modal-body">
                    <div id="fileViewFull">

                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="close-btn" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

</body>

</html>
<script>
    function removeSelectedClass() {
        var allTabs = document.querySelectorAll('[role="tab"]');
        for (i = 0; i < allTabs.length; i++) {
            allTabs[i].classList.remove("selected");
        }
    }
        
    function selectSummary() {
        removeSelectedClass();
        document.getElementById("summary-tab").classList.add("selected");
    }
    
    function selectFiles() {
        removeSelectedClass();
        document.getElementById("files-tab").classList.add("selected");
    }

    function selectNegotiation() {
        removeSelectedClass();
        document.getElementById("negotiation-tab").classList.add("selected");
    }

</script>